<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FSC Digital Record - JSON View</title>
    <style>
        body {
            background-color: #121212;
            color: #ccc;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            margin: 0;
            padding: 20px;
            line-height: 1.4;
        }

        .json-container {
            max-width: 800px;
            margin: auto;
            background: #1e1e1e;
            padding: 24px;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid #333;
        }

        .header {
            border-bottom: 1px solid #333;
            padding-bottom: 12px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 1rem;
            margin: 0;
            color: #4db6ac;
        }

        .key {
            color: #9cdcfe;
        }

        .string {
            color: #ce9178;
        }

        .brace {
            color: #ffd700;
        }

        .bracket {
            color: #da70d6;
        }

        .comma {
            color: #e0e0e0;
        }

        .indent {
            margin-left: 20px;
        }
    </style>
</head>

<body>
    <div class="json-container" id="main-content">
        <div class="header">
            <h1>FSC_JSON_DUMP.sh</h1>
            <span style="font-size: 0.7rem; color: #666;">v11.33 [ENCODED_DIRECT]</span>
        </div>
        <div id="json-view">
            <span class="brace">{</span><br>
            <div id="json-content"></div>
            <span class="brace">}</span>
        </div>
    </div>

    <script>
        const labelMap = {
            f: "fsc_number",
            r: "ref_number",
            d: "district",
            h: "hof_name",
            fs: "shop_number",
            ct: "card_type",
            gc: "gas_connection",
            cn: "consumer_number",
            os: "old_rc_number",
            as: "application_status",
            an: "application_number",
            sn: "sks_form_number",
            on: "office_name",
            is: "impds_status",
            ks: "key_register_no",
            m: "family_members"
        };

        try {
            const urlParams = new URLSearchParams(window.location.search);
            const encodedData = urlParams.get('d');
            const fParam = urlParams.get('f');
            const mParam = urlParams.get('m');

            let data = null;
            if (encodedData) {
                data = JSON.parse(decodeURIComponent(atob(encodedData)));
            } else if (fParam) {
                data = { f: fParam, m: mParam ? mParam.split(',') : [] };
            }

            if (!data) throw new Error("EMPTY");

            const contentEl = document.getElementById('json-content');
            let html = '';

            const keys = Object.keys(data);
            keys.forEach((key, index) => {
                const label = labelMap[key] || key;
                const val = data[key];
                const isLast = index === keys.length - 1;
                const comma = isLast ? '' : '<span class="comma">,</span>';

                if (Array.isArray(val)) {
                    html += `<div class="indent"><span class="key">"${label}"</span><span class="comma">:</span> <span class="bracket">[</span></div>`;
                    val.forEach((item, i) => {
                        const mComma = (i === val.length - 1) ? '' : '<span class="comma">,</span>';
                        html += `<div class="indent" style="margin-left:40px;"><span class="string">"${item}"</span>${mComma}</div>`;
                    });
                    html += `<div class="indent"><span class="bracket">]</span>${comma}</div>`;
                } else {
                    html += `<div class="indent"><span class="key">"${label}"</span><span class="comma">:</span> <span class="string">"${val || '---'}"</span>${comma}</div>`;
                }
            });

            contentEl.innerHTML = html;

        } catch (e) {
            document.getElementById('json-view').innerHTML = '<div class="indent"><span class="key">"error"</span>: <span class="string">"NO_FSC_RECORDS_MAPPED"</span></div>';
        }
    </script>
</body>

</html>